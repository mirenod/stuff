#!/bin/bash

# Read the .env file
while IFS= read -r line || [[ -n "$line" ]]; do
  # Skip empty lines and comments
  if [[ -z "$line" || "$line" == \#* ]]; then
    continue
  fi

  # Extract the key and value
  key=$(echo "$line" | cut -d '=' -f 1)
  value=$(echo "$line" | cut -d '=' -f 2-)

  # Check if the value contains a command
  if [[ "$value" == \$\( * \) ]]; then
    # Execute the command and get the result
    command=$(echo "$value" | sed 's/\$//g' | sed 's/(//g' | sed 's/)//g')
    value=$(eval "$command")
  fi

  # Export the variable
  export "$key=$value"
done < .env

# Print all exported variables (for debugging purposes)
export -p
